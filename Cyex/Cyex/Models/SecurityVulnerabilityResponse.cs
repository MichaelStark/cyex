using System.Text.Json.Serialization;
using Cyex.Enums;

// ReSharper disable ClassNeverInstantiated.Global

namespace Cyex.Models;

public class SecurityVulnerabilityResponse(Data data)
{
    public Data Data { get; init; } = data;
}

public class Data(SecurityVulnerabilities securityVulnerabilities)
{
    public SecurityVulnerabilities SecurityVulnerabilities { get; } = securityVulnerabilities;
}

public class SecurityVulnerabilities(List<SecurityVulnerabilityNode> nodes, PageInfo pageInfo)
{
    public List<SecurityVulnerabilityNode> Nodes { get; } = nodes;
    public PageInfo PageInfo { get; } = pageInfo;
}

public class PageInfo(string endCursor, bool hasNextPage)
{
    public string EndCursor { get; } = endCursor;
    public bool HasNextPage { get; } = hasNextPage;
}

public class SecurityVulnerabilityNode(
    string severity,
    Advisory advisory,
    Package package,
    string vulnerableVersionRange,
    FirstPatchedVersion firstPatchedVersion)
{
    public string Severity { get; } = severity;
    public Advisory Advisory { get; } = advisory;
    public Package Package { get; set; } = package;
    public string VulnerableVersionRange { get; } = vulnerableVersionRange;
    public FirstPatchedVersion? FirstPatchedVersion { get; } = firstPatchedVersion;
}

public class Advisory(string summary)
{
    public string Summary { get; } = summary;
}

public class Package(string name, EcosystemType ecosystem)
{
    public string Name { get; set; } = name;

    [JsonConverter(typeof(JsonStringEnumConverter))]
    public EcosystemType Ecosystem { get; set; } = ecosystem;
}

public class FirstPatchedVersion(string identifier)
{
    public string Identifier { get; } = identifier;
}